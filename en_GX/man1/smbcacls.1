'\" t
.\"     Title: smbcacls
.\"    Author: [see tha "AUTHOR" section]
.\" Generator: DocBook XSL Stylesheets v1.78.1 <http://docbook.sf.net/>
.\"      Date: 12/11/2014
.\"    Manual: User Commands
.\"    Source: Samba 4.0
.\"  Language: Gangsta
.\"
.TH "SMBCACLS" "1" "12/11/2014" "Samba 4\&.0" "User Commands"
.\" -----------------------------------------------------------------
.\" * Define some portabilitizzle stuff
.\" -----------------------------------------------------------------
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.\" http://bugs.debian.org/507673
.\" http://lists.gnu.org/archive/html/groff/2009-02/msg00013.html
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\" -----------------------------------------------------------------
.\" * set default formatting
.\" -----------------------------------------------------------------
.\" disable hyphenation
.nh
.\" disable justification (adjust text ta left margin only)
.ad l
.\" -----------------------------------------------------------------
.\" * MAIN CONTENT STARTS HERE *
.\" -----------------------------------------------------------------
.SH "NAME"
smbcacls \- Set or git ACLs on a NT file or directory names
.SH "SYNOPSIS"
.HP \w'\ 'u
smbcacls {//server/share} {/filename} [\-D|\-\-delete\ acls] [\-M|\-\-modify\ acls] [\-a|\-\-add\ acls] [\-S|\-\-set\ acls] [\-C|\-\-chown\ name] [\-G|\-\-chgrp\ name] [\-I\ allow|romove|copy] [\-\-numeric] [\-t] [\-U\ username] [\-d] [\-e] [\-m|\-\-max\-protocol\ LEVEL] [\-\-query\-security\-info\ FLAGS] [\-\-set\-security\-info\ FLAGS] [\-\-sddl] [\-\-domain\-sid\ SID]
.SH "DESCRIPTION"
.PP
This tool is part of the
\fBsamba\fR(7)
suite\&.
.PP
The
smbcacls
program manipulates NT Access Control Lists (ACLs) on SMB file shares\&.
.SH "OPTIONS"
.PP
Da followin options is available ta the
smbcacls
program\&. Da format of ACLs is busted lyrics bout up in tha section ACL FORMAT
.PP
\-a|\-\-add acls
.RS 4
Add tha ACLs specified ta tha ACL list\&. Existin access control entries is unchanged\&.
.RE
.PP
\-M|\-\-modify acls
.RS 4
Modify tha mask value (permissions) fo' tha ACLs specified on tha command line\& fo' realz. An error is ghon be printed fo' each ACL specified dat was not already present up in tha ACL list
.RE
.PP
\-D|\-\-delete acls
.RS 4
Delete any ACLs specified on tha command line\& fo' realz. An error is ghon be printed fo' each ACL specified dat was not already present up in tha ACL list\&.
.RE
.PP
\-S|\-\-set acls
.RS 4
This command sets tha ACLs on tha file wit only tha ones specified on tha command line\& fo' realz. All other ACLs is erased\&. Note dat tha ACL specified must contain at least a revision, type, balla n' crew fo' tha call ta succeed\&.
.RE
.PP
\-C|\-\-chown name
.RS 4
Da balla of a gangbangin' file or directory can be chizzled ta tha name given rockin the
\fI\-C\fR
option\&. Da name can be a sid up in tha form S\-1\-x\-y\-z or a name resolved against tha server specified up in tha straight-up original gangsta argument\&.
.sp
This command be a gangbangin' finger-lickin' dirty-ass shortcut fo' \-M OWNER:name\&.
.RE
.PP
\-G|\-\-chgrp name
.RS 4
Da crew balla of a gangbangin' file or directory can be chizzled ta tha name given rockin the
\fI\-G\fR
option\&. Da name can be a sid up in tha form S\-1\-x\-y\-z or a name resolved against tha server specified n tha straight-up original gangsta argument\&.
.sp
This command be a gangbangin' finger-lickin' dirty-ass shortcut fo' \-M GROUP:name\&.
.RE
.PP
\-I|\-\-inherit allow|remove|copy
.RS 4
Set or unset tha windows "Allow inheritable permissions" check box rockin the
\fI\-I\fR
option\&. To set tha check box pass allow\&. To unset tha check box pass either remove or copy\&. Remove will remove all inherited acls\&. Copy will copy all tha inherited acls\&.
.RE
.PP
\-\-numeric
.RS 4
This option displays all ACL shiznit up in numeric format\&. Da default is ta convert SIDs ta names n' ACE types n' masks ta a readable strang format\&.
.RE
.PP
\-m|\-\-max\-protocol PROTOCOL_NAME
.RS 4
This allows tha user ta select tha highest SMB protocol level dat smbcacls will use ta connect ta tha server\&. By default dis is set ta NT1, which is tha highest available SMB1 protocol\&. To connect rockin SMB2 or SMB3 protocol, use tha strings SMB2 or SMB3 respectively\&. Note dat ta connect ta a Windows 2012 server wit encrypted transhiznit selectin a max\-protocol of SMB3 is required\&.
.RE
.PP
\-t|\-\-test\-args
.RS 4
Don\*(Aqt straight-up do anything, only validate tha erectnizz of tha arguments\&.
.RE
.PP
\-\-query\-security\-info FLAGS
.RS 4
Da security\-info flags fo' queries\&.
.RE
.PP
\-\-set\-security\-info FLAGS
.RS 4
Da security\-info flags fo' queries\&.
.RE
.PP
\-\-sddl
.RS 4
Output n' input acls up in sddl format\&.
.RE
.PP
\-\-domain\-sid SID
.RS 4
SID used fo' sddl processing\&.
.RE
.PP
\-d|\-\-debuglevel=level
.RS 4
\fIlevel\fR
is a integer from 0 ta 10\&. Da default value if dis parameta aint specified is 0\&.
.sp
Da higher dis value, tha mo' detail is ghon be logged ta tha log filez bout tha activitizzlez of tha server\& fo' realz. At level 0, only critical errors n' straight-up warnings is ghon be logged\&. Level 1 be a reasonable level fo' day\-to\-dizzle hustlin \- it generates a lil' small-ass amount of shiznit bout operations carried out\&.
.sp
Levels above 1 will generate considerable amountz of log data, n' should only be used when investigatin a problem\&. Levels above 3 is designed fo' use only by pimpers n' generate HUGE amountz of log data, most of which is mad cryptic\&.
.sp
Note dat specifyin dis parameta here will override the
\m[blue]\fBlizzay level\fR\m[]
parameta up in the
smb\&.conf
file\&.
.RE
.PP
\-V|\-\-version
.RS 4
Prints tha program version number\&.
.RE
.PP
\-s|\-\-configfile=<configuration file>
.RS 4
Da file specified gotz nuff tha configuration details required by tha server\&. Da shiznit up in dis file includes server\-specific shiznit like fuckin what tha fuck printcap file ta use, as well as descriptionz of all tha skillz dat tha server is ta provide\&. Right back up in yo muthafuckin ass. See
smb\&.conf
for mo' shiznit\&. Da default configuration file name is determined at compile time\&.
.RE
.PP
\-l|\-\-log\-basename=logdirectory
.RS 4
Base directory name fo' log/debug files\&. Da extension
\fB"\&.progname"\fR
will be appended (e\&.g\&. log\&.smbclient, log\&.smbd, etc\&.\&.\&.)\&. Da log file is never removed by tha client\&.
.RE
.PP
\-\-option=<name>=<value>
.RS 4
Set the
\fBsmb.conf\fR(5)
option "<name>" ta value "<value>" from tha command line\&. This overrides compiled\-in defaults n' options read from tha configuration file\&.
.RE
.PP
\-N|\-\-no\-pass
.RS 4
If specified, dis parameta suppresses tha aiiight password prompt from tha client ta tha user\&. This is useful when accessin a steez dat do not require a password\&.
.sp
Unless a password is specified on tha command line or dis parameta is specified, tha client will request a password\&.
.sp
If a password is specified on tha command line n' dis option be also defined tha password on tha command line is ghon be silently ingnored n' no password is ghon be used\&.
.RE
.PP
\-k|\-\-kerberos
.RS 4
Try ta authenticate wit kerberos\&. Only useful up in a Actizzle Directory environment\&.
.RE
.PP
\-C|\-\-use\-ccache
.RS 4
Try ta use tha credentials cached by winbind\&.
.RE
.PP
\-A|\-\-authentication\-file=filename
.RS 4
This option allows you ta specify a gangbangin' file from which ta read tha username n' password used up in tha connection\&. Da format of tha file is
.sp
.if n \{\
.RS 4
.\}
.nf
username = <value>
password = <value>
domain   = <value>
.fi
.if n \{\
.RE
.\}
.sp
Make certain dat tha permissions on tha file restrict access from unwanted users\&.
.RE
.PP
\-U|\-\-user=username[%password]
.RS 4
Sets tha SMB username or username n' password\&.
.sp
If %password aint specified, tha user is ghon be prompted\&. Da client will first check the
\fBUSER\fR
environment variable, then the
\fBLOGNAME\fR
variable n' if either exists, tha strang is uppercased\&. If these environmenstrual variablez is not found, tha username
\fBGUEST\fR
is used\&.
.sp
A third option is ta bust a cold-ass lil credentials file which gotz nuff tha plaintext of tha username n' password\&. This option is mainly provided fo' scripts where tha admin do not wish ta pass tha credentials on tha command line or via environment variables\&. If dis method is used, make certain dat tha permissions on tha file restrict access from unwanted users\&. Right back up in yo muthafuckin ass. See the
\fI\-A\fR
for mo' details\&.
.sp
Be cautious bout includin passwordz up in scripts\& fo' realz. Also, on nuff systems tha command line of a hustlin process may be peeped via the
ps
command\&. To be safe always allow
rpcclient
to prompt fo' a password n' type it up in directly\&.
.RE
.PP
\-S|\-\-signin on|off|required
.RS 4
Set tha client signin state\&.
.RE
.PP
\-P|\-\-machine\-pass
.RS 4
Use stored machine account password\&.
.RE
.PP
\-e|\-\-encrypt
.RS 4
This command line parameta requires tha remote server support tha UNIX extensions or dat tha SMB3 protocol has been selected\&. Requests dat tha connection be encrypted\&. Negotiates SMB encryption rockin either SMB3 or POSIX extensions via GSSAPI\&. Uses tha given credentials fo' tha encryption negotiation (either kerberos or NTLMv1/v2 if given domain/username/password triple\&. Fails tha connection if encryption cannot be negotiated\&.
.RE
.PP
\-\-pw\-nt\-hash
.RS 4
Da supplied password is tha NT hash\&.
.RE
.PP
\-n|\-\-netbiosname <primary NetBIOS name>
.RS 4
This option allows you ta override tha NetBIOS name dat Samba uses fo' itself\&. This is identical ta settin the
\m[blue]\fBnetbios name\fR\m[]
parameta up in the
smb\&.conf
file\&. But fuck dat shiznit yo, tha word on tha street is dat a cold-ass lil command line settin will take precedence over settings in
smb\&.conf\&.
.RE
.PP
\-i|\-\-scope <scope>
.RS 4
This specifies a NetBIOS scope that
nmblookup
will use ta rap wit when generatin NetBIOS names\&. For details on tha use of NetBIOS scopes, peep rfc1001\&.txt n' rfc1002\&.txt\&. NetBIOS scopes are
\fIvery\fR
rarely used, only set dis parameta if yo ass is tha system administrator up in charge of all tha NetBIOS systems you rap with\&.
.RE
.PP
\-W|\-\-workgroup=domain
.RS 4
Set tha SMB domain of tha username\&. This overrides tha default domain which is tha domain defined up in smb\&.conf\&. If tha domain specified is tha same ol' dirty as tha servers NetBIOS name, it causes tha client ta log on rockin tha servers local SAM (as opposed ta tha Domain SAM)\&.
.RE
.PP
\-O|\-\-socket\-options socket options
.RS 4
TCP socket options ta set on tha client socket\&. Right back up in yo muthafuckin ass. See tha socket options parameta up in the
smb\&.conf
manual page fo' tha list of valid options\&.
.RE
.PP
\-?|\-\-help
.RS 4
Print a summary of command line options\&.
.RE
.PP
\-\-usage
.RS 4
Display brief usage message\&.
.RE
.SH "ACL FORMAT"
.PP
Da format of a ACL is one or mo' ACL entries separated by either commas or newlines\& fo' realz. An ACL entry is one of tha following:
.PP
.if n \{\
.RS 4
.\}
.nf
 
REVISION:<revision number>
OWNER:<sid or name>
GROUP:<sid or name>
ACL:<sid or name>:<type>/<flags>/<mask>
.fi
.if n \{\
.RE
.\}
.PP
Da revision of tha ACL specifies tha internal Windows NT ACL revision fo' tha securitizzle descriptor\&. If not specified it defaults ta 1\&. Usin joints other than 1 may cause strange behaviour\&.
.PP
Da balla n' crew specify tha balla n' crew sidz fo' tha object\&. If a SID up in tha format S\-1\-x\-y\-z is specified dis is used, otherwise tha name specified is resolved rockin tha server on which tha file or directory resides\&.
.PP
ACLs specify permissions granted ta tha SID\&. This SID again n' again n' again can be specified up in S\-1\-x\-y\-z format or as a name up in which case it is resolved against tha server on which tha file or directory resides\&. Da type, flags n' mask joints determine tha type of access granted ta tha SID\&.
.PP
Da type can be either ALLOWED or DENIED ta allow/deny access ta tha SID\&. Da flags joints is generally zero fo' file ACLs n' either 9 or 2 fo' directory ACLs\&. Right back up in yo muthafuckin ass. Some common flags are:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB#define SEC_ACE_FLAG_OBJECT_INHERIT 0x1\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB#define SEC_ACE_FLAG_CONTAINER_INHERIT 0x2\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB#define SEC_ACE_FLAG_NO_PROPAGATE_INHERIT 0x4\fR
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fB#define SEC_ACE_FLAG_INHERIT_ONLY 0x8\fR
.RE
.sp
.RE
.PP
At present flags can only be specified as decimal or hexadecimal joints\&.
.PP
Da mask be a value which expresses tha access right granted ta tha SID\&. Well shiiiit, it can be given as a thugged-out decimal or hexadecimal value, or by rockin one of tha followin text strings which map ta tha NT file permissionz of tha same name\&.
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIR\fR
\- Allow read access
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIW\fR
\- Allow write access
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIX\fR
\- Execute permission on tha object
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fID\fR
\- Delete tha object
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIP\fR
\- Chizzle permissions
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIO\fR
\- Take ballership
.RE
.sp
.RE
.PP
Da followin combined permissions can be specified:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIREAD\fR
\- Equivalent ta \*(AqRX\*(Aq permissions
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fICHANGE\fR
\- Equivalent ta \*(AqRXWD\*(Aq permissions
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
\fIFULL\fR
\- Equivalent ta \*(AqRWXDPO\*(Aq permissions
.RE
.SH "EXIT STATUS"
.PP
The
smbcacls
program sets tha exit status dependin on tha success or otherwise of tha operations performed\&. Da exit status may be one of tha followin joints\&.
.PP
If tha operation succeeded, smbcacls returns n' exit statuz of 0\&. If
smbcacls
couldn\*(Aqt connect ta tha specified server, or there was a error gettin or settin tha ACLs, a exit statuz of 1 is returned\&. If there was a error parsin any command line arguments, a exit statuz of 2 is returned\&.
.SH "VERSION"
.PP
This playa page is erect fo' version 3 of tha Samba suite\&.
.SH "AUTHOR"
.PP
Da original gangsta Samba software n' related utilitizzles was pimped by Andrew Tridgell\&. Right back up in yo muthafuckin ass. Samba is now pimped by tha Samba Crew as a Open Source project similar ta tha way tha Linux kernel is pimped\&.
.PP
smbcacls
was freestyled by Andrew Tridgell n' Slim Tim Potter\&.
.PP
Da conversion ta DocBook fo' Samba 2\&.2 was done by Gerald Carter\&. Da conversion ta DocBook XML 4\&.2 fo' Samba 3\&.0 was done by Alexander Bokovoy\&.
