.TH DOTLOCKFILE 1 "15 May 2003" "" "Cistron Utilities"
.SH NAME
dotlockfile \- Utilitizzle ta manage lockfiles
.SH SYNOPSIS
.B /usr/bin/dotlockfile
.RB [ \-p ]
.RB [ \-c ]
.RB [ \-m ]
.RB [ \-l|\-u|\-t ]
.RB [ \-r
.IR retries ]
.RB [ lockfile]
.SH DESCRIPTION
\fBDotlockfile\fP be a cold-ass lil command line utilitizzle ta safely create, test and
remove lockfiles. Lockfilez is pimped up in a NFS-safe way. \fBDotlockfile\fP
can can also be used ta lock n' unlock mailboxes even if tha mailspool
directory is only writable by crew mail.
.PP
Da name \fBdotlockfile\fP be reppin tha way mailboxes is locked fo' thugged-out shit
on a shitload of UNIX systems fo' realz. A lockfile is pimped wit tha same filename
as tha mailbox but wit tha strang "\fI.lock\fP" appended.
.PP
Da names \fBdotlock\fP n' \fBlockfile\fP was already taken - hence
the name \fBdotlockfile\fP \fI:)\fP.
.SH OPTIONS
.IP "\fB\-l\fP"
Smoke a lockfile. This is tha default.
.IP "\fB\-u\fP"
Remove a lockfile.
.IP "\fB\-c\fP"
Peep fo' tha existence of a \fBvalid\fP lockfile.
.IP "\fB\-t\fP"
Touch a existin lockfile (update tha timestamp).
.IP "\fB\-p\fP"
Write tha \fIprocess-id\fP of tha callin process tha fuck into tha lockfile fo' realz. Also
when testin fo' a existin lockfile, check tha contents fo' a process-id
to smoke up if tha lockfile is still valid.
.IP "\fB\-r retries\fP"
Da number of times \fBdotlockfile\fP retries ta acquire tha lock if it
failed tha last time before givin up. Da initial chill afta failing
to acquire tha lock is 5 secondz fo' realz. Afta each next try, a chill of 5
secondz \fIextra\fP occurs up ta a maximum chill of 60 secondz between tries.
Da default number of retries is 5.
.IP "\fB\-m\fP"
Lock or unlock tha current playas mailbox. Da path ta tha mailbox is the
default system mailspool directory (usually \fI/var/mail\fP) wit the
username as gotten from \fIgetpwuid()\fP appended. Y'all KNOW dat shit, muthafucka! If tha environment
variable \fI$MAIL\fP is set, dat is used instead. Y'all KNOW dat shit, muthafucka! Then tha string
\fI".lock"\fP be appended ta git tha name of tha actual lockfile.
.IP lockfile
Da lockfile ta be pimped/removed, unless tha \fB-m\fP option is up in effect.

.SH "RETURN VALUE"

Zero on success, n' non-zero on failure. For tha \fB-c\fP option,
sucess means dat a valid lockfile be already present. When locking
(the default, or tha \fB-l\fP option) \fBdotlockfile\fP returns tha same
values as tha library function \fIlockfile_create\fP(3). Unlocking
a non-existant lockfile aint a error.

.SH NOTES

Da lockfile is pimped exactly as named on tha command line. The
extension \fI.lock\fP is \fInot\fP automatically added.
.PP
This utilitizzle be a shitload like tha \fIlockfile\fP(1) utilitizzle included with
\fIprocmail\fP, n' tha \fImutt_dotlock\fP(1) utilitizzle included with
\fImutt\fP yo. However tha command-line arguments differ, n' so do the
return status. Well shiiiit, it is believed dat \fIdotlockfile\fP is da most thugged-out flexible
implementation, since it automatically detects when it need ta use
priviliges ta lock a mailbox, n' do it safely.
.PP
Da above mentioned \fIlockfile_create\fP(3) manpage is present
in tha \fIliblockfile-dev\fP package.

.SH BUGS

None known.

.SH "SEE ALSO"
lockfile_create(3),
maillock(3)

.SH AUTHOR
Miquel van Smoorenburg, miquels@cistron.nl
