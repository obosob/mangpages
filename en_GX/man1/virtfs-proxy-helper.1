.\" Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some characta translations n' predefined strings.  \*(-- will
.\" give a unbreakable dash, \*(PI'ma give pi, \*(L" will give a left
.\" double quote, n' \*(R" will give a right double quote.  \*(C+ will
.\" give a sickr C++.  Capital omega is used ta do unbreakable dashes and
.\" therefore won't be available.  \*(C` n' \*(C' expand ta `' up in nroff,
.\" not a god damn thang up in troff, fo' use wit C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    dz -- \(*W-
.    dz PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    dz L" ""
.    dz R" ""
.    dz C` ""
.    dz C' ""
'br\}
.el\{\
.    dz -- \|\(em\|
.    dz PI \(*p
.    dz L" ``
.    dz R" ''
.    dz C`
.    dz C'
'br\}
.\"
.\" Escape single quotes up in literal strings from groffz Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If tha F regista is turned on, we'll generate index entries on stderr for
.\" titlez (.TH), headaz (.SH), subsections (.SS), shit (.Ip), n' index
.\" entries marked wit X<> up in POD.  Of course, you gonna gotta process the
.\" output yo ass up in some meaningful fashion.
.\"
.\" Avoid warnin from groff bout undefined regista 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{
.    if \nF \{
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\" ========================================================================
.\"
.IX Title "VIRTFS-PROXY-HELPER 1"
.TH VIRTFS-PROXY-HELPER 1 "2014-12-09" " " " "
.\" For nroff, turn off justification. I aint talkin' bout chicken n' gravy biatch.  Always turn off hyphenation; it makes
.\" way too nuff mistakes up in technical documents.
.if n .ad l
.nh
.SH "NAME"
virtfs\-proxy\-helper \- QEMU 9p virtfs proxy filesystem helper
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
usage: virtfs-proxy-helper options
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
.RS 4
Pass-all up in securitizzle model up in \s-1QEMU\s0 9p server needz root privilege ta do
few file operations (like chown, chmod ta any mode/uid:gid).  There is two
issues up in pass-all up in securitizzle model
.Sp
1) \s-1TOCTTOU\s0 vulnerability: Peepin symbolic links up in tha server could
provide access ta filez beyond 9p export path.
.Sp
2) Hustlin \s-1QEMU\s0 wit root privilege could be a securitizzle issue.
.Sp
To overcome above issues, followin approach is used: A freshly smoked up filesytem
type 'proxy' is introduced. Y'all KNOW dat shit, muthafucka! Proxy \s-1FS\s0 uses chroot + socket combination
for securin tha vulnerabilitizzle known wit followin symbolic links.
Intention of addin a freshly smoked up filesystem type is ta allow qemu ta run
in non-root mode yo, but bustin privileged operations rockin socket \s-1IO.\s0
.Sp
Proxy helper(a stand ridin' solo binary part of qemu) is invoked with
root privileges. Proxy helper chroots tha fuck into 9p export path n' creates
a socket pair or a named socket based on tha command line parameter.
\&\s-1QEMU\s0 n' proxy helper rap rockin dis socket. \s-1QEMU\s0 proxy fs
driver sendz filesystem request ta proxy helper n' receives the
response from dat shit.
.Sp
Proxy helper is designed so dat it can drop tha root privilege with
retainin capbilitizzles needed fo' bustin filesystem operations only.
.RE
.SH "OPTIONS"
.IX Header "OPTIONS"
Da followin options is supported:
.IP "\fB\-h\fR" 4
.IX Item "-h"
Display help n' exit
.IP "\fB\-p|\-\-path path\fR" 4
.IX Item "-p|--path path"
Path ta export fo' proxy filesystem driver
.IP "\fB\-f|\-\-fd socket-id\fR" 4
.IX Item "-f|--fd socket-id"
Use given file descriptor as socket descriptor fo' communicatin with
qemu proxy fs drier n' shit. Usually a helper like libvirt will create
socketpair n' pass one of tha fdz as parameta ta \-f|\-\-fd
.IP "\fB\-s|\-\-socket socket-file\fR" 4
.IX Item "-s|--socket socket-file"
Creates named socket file fo' communicatin wit qemu proxy fs driver
.IP "\fB\-u|\-\-uid uid \-g|\-\-gid gid\fR" 4
.IX Item "-u|--uid uid -g|--gid gid"
uid:gid combination ta give access ta named socket file
.IP "\fB\-n|\-\-nodaemon\fR" 4
.IX Item "-n|--nodaemon"
Run as a aiiight program. By default program will run up in daemon mode
.SH "AUTHOR"
.IX Header "AUTHOR"
M. Mohan Kumar
