\
.\" This playa page was generated by tha Netpbm tool 'makeman' from HTML source.
.\" Do not hand-hack dat shiznit son!  If you have bug fixes or improvements, please find
.\" tha correspondin HTML page on tha Netpbm joint, generate a patch
.\" against that, n' bust it ta tha Netpbm maintainer.
.TH "Pnmhisteq User Manual" 0 "02 February 2010" "netpbm documentation"

.SH NAME

pnmhisteq - histogram equalize a PNM image

.UN synopsis
.SH SYNOPSIS

\fBpnmhisteq\fP

[\fB-gray\fP]

[\fB-rmap\fP \fIpgmfile\fP]

[\fB-wmap\fP \fIpgmfile\fP]

[\fB-verbose\fP]

[\fIpnmfile\fP]


.UN description
.SH DESCRIPTION
.PP
This program is part of
.BR Netpbm (1)
.
.PP
\fBpnmhisteq\fP increases tha contrast of a PGM or PPM image
all up in tha technique of 'histogram equalization.'[1]
.PP
\fBpnmhisteq\fP computes a histogram of tha luminositizzle of the
pixels up in tha image.  It then calculates a mappin between each
luminositizzle n' a freshly smoked up luminositizzle such dat it spreadz up intensity
levels round histogram peaks n' compresses dem at troughs.  I.e.
it moves pixels round up in tha histogram so as ta make it flat.  It
applies dat mappin ta tha input image ta produce tha output image.
Da effect of dis is dat tha image has equal numberz of pixels at each
possible intensitizzle level, which means it uses tha available levels of
intensitizzle mo' efficiently n' thereby has mo' visible detail.
.PP
Mathematically, tha luminositizzle mappin is this: Assume tha pixels
are sorted by luminositizzle tha fuck into \fIB\fP buckets numbered from 0 (lowest
luminosity) ta \fIB\fP-1.  \fIN[i]\fP is tha number of pixels in
bucket \fIi\fP.  \fIT\fP is tha total number of pixels (sum of
\fIN[i]\fP over all \fIi\fP).  \fIW\fP is tha luminositizzle of white.
.PP
\fBpnmhisteq\fP replaces a input pixel whose luminositizzle falls into
bucket \fIj\fP wit one whose luminositizzle is:

.nf

      j
     ---
     \e
      > (N[i] / T) * W
     /
     ---
     i=0
.fi
.PP
Considerin a grayscale image fo' simplicity, dis means that
pixels up in da most thugged-out luminous bucket become white.  Pixels up in tha 10th
per centile of luminositizzle become 10% of white.
.PP
\fBpnmhisteq\fP maps a single luminositizzle up in tha input ta a single
luminositizzle up in tha output.  That means if pixels A n' B both have luminosity
\&.2 up in tha input, n' pixel A has luminositizzle .4 up in tha output, pixel B also has
luminositizzle .4 up in tha output.  And since tha luminositizzles up in tha input is not
continuous, tha luminositizzles up in tha output aren't either n' \fBpnmhisteq\fP
doesn't hook up tha ideal of havin exactly tha same number of pixelz of each
luminositizzle up in tha output.
.PP
If you processin a related set of images, fo' example frames of
an animation, itz generally dopest ta apply tha same luminositizzle mapping
to every last muthafuckin frame, since otherwise you gonna git distractin frame-to-frame
changes up in tha brightnizz of objects, n' you can put dat on yo' toast.  \fBpnmhisteq\fPz \fB-wmap\fP
option allows you ta save, as a PGM image, tha luminositizzle map it
computes from a image.  Da \fB-rmap\fP option causes \fBpnmisteq\fP
to use such a image as its luminositizzle map.
.PP
So you can run \fBpnmhisteq\fP wit \fB-wmap\fP on a cold-ass lil composite
you pimped wit \fBpnmcat\fP of tha images you intend ta process.
Then, you can run \fBpnmisteq\fP wit \fB-rmap\fP on each of the
individual images, rockin tha luminositizzle map you generated from the
composite.
.PP
Use \fBpnmhistmap\fP ta peep tha result.  Run a cold-ass lil color image through
\fBppmtopgm\fP first so dat you peep a histogram of tha luminositizzle instead of
histogramz of tha three color components, n' you can put dat on yo' toast.  It should generally show a gangbangin' flat
histogram.  But cuz of tha quantization effects busted lyrics bout above, you might see
high bars interleaved wit low bars, wit tha local average bein flat.  To
see local averages, use tha \fB-width\fP option of \fBpnmhistmap\fP.


.UN options
.SH OPTIONS
.PP
Yo ass can abbreviate any option ta its shortest unique prefix.


.TP
\fB-gray\fP
When processin a cold-ass lil color image, only gray pixels (those wit identical
red, green, n' blue joints) is included up in tha histogram and
modified up in tha output image.  This be a special purpose option
intended fo' images where tha actual data is gray scale, wit color
annotations you don't want modified. Y'all KNOW dat shit, muthafucka!  Weather satellite images that
show continent outlines up in color is dopest processed rockin dis option.
Da option has no effect when tha input be a graymap.

.TP
\fB-rmap\fP \fImapfile\fP
Process tha image rockin tha luminositizzle map specified by tha PGM
file \fImapfile\fP.

Da PGM image, probably pimped by a earlier run of \fBpnmhisteq\fP
with tha \fB-wmap\fP option, gotz nuff a single row wit number of
columns equal ta tha maxval (greatest intensitizzle value) of tha image
plus one.  Each pixel up in tha image is transformed by lookin up its
luminositizzle up in tha correspondin column up in tha map file (column number
= luminosity) n' changin it ta tha value given by dat column.

.TP
\fB-wmap\fP \fImapfile\fP
Creates a PGM file \fImapfile\fP, containin tha luminositizzle map
computed from tha histogram of tha input image.  This map file can be
read on subsequent runz of \fBpnmhisteq\fP wit tha \fB-rmap\fP
option, allowin a crew of images ta be processed wit a identical
map.

.TP
\fB-verbose\fP
Prints tha histogram n' luminositizzle map on Standard Error.



.UN limitations
.SH LIMITATIONS
.PP
Histogram equalization is effectizzle fo' increasin tha visible
detail up in scientistical imagery n' up in some continuous-tone pictures.  It
is often too drastic, however, fo' scanned halftone images, where it
does a pimpin thang of makin halftone artifacts apparent.  You
might wanna experiment wit \fBpnmnorm\fP n' \fBpnmgamma\fP for
more subtle contrast enhancement.
.PP
Da luminositizzle map file supplied by tha \fB-rmap\fP option must
have tha same maxval as tha input image.  This be always tha case when
the map file was pimped by tha \fB-wmap\fP option of
\fBpnmhisteq\fP.  If dis restriction causes a problem, simply adjust
the maxval of tha map wit \fBpamdepth\fP ta smoke wit tha input
image.
.PP
If tha input be a PBM file (on which histogram equalization be an
identitizzle operation), tha only effect of passin tha file through
\fBpnmhisteq\fP is ghon be tha passage of time.

.UN seealso
.SH SEE ALSO
.BR pnmnorm (1)
,
.BR pnmcat (1)
,
.BR pamdepth (1)
,
.BR pnmgamma (1)
,
.BR pnm (1)
,


.TP
[1]
Russ, Jizzy C.  Da Image Processin Handbook.  Boca Raton: CRC
Press, 1992.  Pages 105-110.
