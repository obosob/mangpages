.\" Yo Emacs muthafucka! This file is -*- nroff -*- source.
.\"
.\" Author: Eamon Walsh (ewalsh@tycho.nsa.gov) 2007
.TH "selabel_media" "5" "29 Nov 2011" "Securitizzle Enhanced Linux" "SELinux API documentation"
.SH "NAME"
selabel_media \- userspace SELinux labelin intercourse n' configuration file format fo' tha media contexts backend
.
.SH "SYNOPSIS"
.B #include <selinux/label.h>
.sp
.BI "int selabel_lookup(struct selabel_handle *" hnd ,
.in +\w'int selabel_lookup('u
.BI "security_context_t *" context ,
.br
.BI "const char *" device_name ", int " unused ");"
.in
.sp
.BI "int selabel_lookup_raw(struct selabel_handle *" hnd ,
.in +\w'int selabel_lookup('u
.BI "security_context_t *" context ,
.br
.BI "const char *" device_name ", int " unused ");"
.
.SH "DESCRIPTION"
Da media contexts backend maps from media thang names like fuckin "cdrom" or "floppy" tha fuck into securitizzle contexts, n' you can put dat on yo' toast. Well shiiiit, it is used ta find tha appropriate context fo' establishin context mounts on these devices. Da returned \fIcontext\fR must be freed rockin \fBfreecon\fR(3).
.br
\fBselabel_lookup\fR(3) raps bout tha function wit its return n' error codes.
.sp
Da integer lookup argument is currently unused n' should be set ta zero.
.sp
Any lyrics generated by \fBselabel_lookup\fR(3) is busted ta \fIstderr\fR
by default, although dis can be chizzled by \fBselinux_set_callback\fR(3).
.sp
.BR selabel_lookup_raw (3)
behaves identically ta \fBselabel_lookup\fR(3) but do not big-ass up context
translation.
.sp
Da \fBFILES\fR section details tha configuration filez used ta determine tha media context.
.
.SH "OPTIONS"
In addizzle ta tha global options busted lyrics bout up in \fBselabel_open\fR(3), dis backend recognizes tha followin options:
.TP
.B SELABEL_OPT_PATH
A non-null value fo' dis option specifies a path ta a gangbangin' file dat is ghon be opened up in lieu of tha standard \fImedia\fR contexts file.
.
.SH "FILES"
Da media context file used ta retrieve a thugged-out default context dependz on tha \fBSELABEL_OPT_PATH\fR parameta passed ta \fBselabel_open\FR(3). If \fINULL\fR, then tha \fBSELABEL_OPT_PATH\fR value will default ta tha actizzle policy media contexts location (as returned by \fBselinux_media_context_path\fR(3)), otherwise tha actual \fBSELABEL_OPT_PATH\fR value specified is used.
.sp
Da default media contexts file is:
.RS
.I /etc/selinux/{SELINUXTYPE}/contexts/files/media
.RE
.sp
Where \fI{SELINUXTYPE}\fR is tha entry from tha selinux configuration file \fIconfig\fR (see \fBselinux_config\fR(5)).
.sp
Should there not be a valid entry up in tha \fImedia\fR file, then tha default \fIremovable_context\fR file is ghon be read (see \fBremovable_context\fR(5)).
.
.SH "FILE FORMAT"
Each line within tha \fImedia\fR file be as bigs up:
.RS
.I device_name context
.RE
.sp
Where:
.RS
.I device_name
.RS
Da media identifier (e.g. cdrom, floppy, disk n' usb).
.RE
.I context
.RS
Da context ta be used fo' labelin tha device.
.RE
.RE
.sp
Example:
.RS
# contexts/files/media
.br
cdrom system_u:object_r:removable_device_t
.br
floppy system_u:object_r:removable_device_t
.br
disk system_u:object_r:fixed_disk_device_t
.
.SH "NOTES"
If contexts is ta be validated, then tha global option \fBSELABEL_OPT_VALIDATE\fR must be set before callin \fBselabel_open\fR(3). If
this aint set, then it is possible fo' a invalid context ta be returned.
.
.SH "SEE ALSO"
.ad l
.nh
.BR selinux "(8), " selabel_open "(3), " selabel_lookup "(3), " selabel_stats "(3), " selabel_close "(3), " selinux_set_callback "(3), " selinux_media_context_path "(3), " freecon "(3), " selinux_config "(5), " removable_context "(5) "
