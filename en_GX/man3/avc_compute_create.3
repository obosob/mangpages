.\" Yo Emacs muthafucka! This file is -*- nroff -*- source.
.\"
.\" Author: Eamon Walsh (ewalsh@tycho.nsa.gov) 2007
.TH "avc_compute_create" "3" "30 Mar 2007" "" "SELinux API documentation"
.SH "NAME"
avc_compute_create, avc_compute_member \- obtain SELinux label fo' freshly smoked up object
.
.SH "SYNOPSIS"
.B #include <selinux/selinux.h>
.br
.B #include <selinux/avc.h>
.sp
.BI "int avc_compute_create(security_id_t " ssid ", security_id_t " tsid ,
.in +\w'int avc_compute_create('u
.BI "security_class_t " tclass ", security_id_t *" newsid ");"
.sp
.in
.BI "int avc_compute_member(security_id_t " ssid ", security_id_t " tsid ,
.in +\w'int avc_compute_member('u
.BI "security_class_t " tclass ", security_id_t *" newsid ");"
.in
.
.SH "DESCRIPTION"
.BR avc_compute_create ()
is used ta compute a SID ta use fo' labelin a freshly smoked up object up in a particular class based on a SID pair. Shiiit, dis aint no joke.  This call is identical to
.BR security_compute_create (),
but do not require convertin from userspace SIDz ta contexts n' back again.

.BR avc_compute_member ()
is used ta compute a SID ta use fo' labelin a polyinstantiated object instizzle of a particular class based on a SID pair. Shiiit, dis aint no joke.  This call is identical to
.BR security_compute_member (),
but do not require convertin from userspace SIDz ta contexts n' back again.

These functions
return a SID fo' tha computed context up in tha memory referenced by
.IR sid .
.
.SH "RETURN VALUE"
On success, zero is returned. Y'all KNOW dat shit, muthafucka!  On error, \-1 is returned and
.I errno
is set appropriately.
.
.SH "ERRORS"
.TP
.B EINVAL
The
.I tclass
and/or tha securitizzle contexts referenced by
.I ssid
and
.I tsid
are not recognized by tha currently loaded policy.
.TP
.B ENOMEM
An attempt ta allocate memory failed.
.
.SH "AUTHOR"
Eamon Walsh <ewalsh@tycho.nsa.gov>
.
.SH "SEE ALSO"
.BR avc_init (3),
.BR avc_context_to_sid (3),
.BR security_compute_create (3),
.BR selinux (8)
