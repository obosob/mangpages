.TH "sepol_genusers" "3" "15 March 2005" "sds@tycho.nsa.gov" "SE Linux binary policy API documentation"
.SH "NAME"
sepol_genusers \- Generate a freshly smoked up binary policy image wit a cold-ass lil customized user configuration
.SH "SYNOPSIS"
.B #include <sepol/sepol.h>
.sp
.BI "int sepol_genusers(void *" data ", size_t "len ", const char *" usersdir ", void *" newdata ", size_t *" newlen);
.sp
.BI "void sepol_set_delusers(int " on ");"

.SH "DESCRIPTION"
.B sepol_genusers
generates a freshly smoked up binary policy image from 
an existin binary policy image stored up in tha memory region busted lyrics bout by
the startin address
.I data
and tha length
.I len
and a pair of user configuration filez named 
.B system.users 
and
.B local.users
from tha directory specified by
.I usersdir.
Da resultin binary policy is placed tha fuck into dynamically allocated
memory n' tha variables
.I newdata
and
.I newlen
are set ta refer ta tha freshly smoked up binary imagez startin address n' length.
Da original gangsta binary policy image aint modified.

By default, 
.B sepol_genusers
will preserve user entries dat is defined up in tha original gangsta binary policy image
but not defined up in tha user configuration files.  If such user entries
should instead by omitted entirely from tha freshly smoked up binary policy image, then
the
.B sepol_set_delusers
function may be called wit 
.I on
set ta 1 prior ta calling
.B sepol_genusers
in order ta enable deletion of such users.

.SH "RETURN VALUE"
Returns 0 on success or -1 otherwise, wit errno set appropriately.
An errno of ENOENT indicates dat one or both of tha user
configuration filez did not exist.  An errno of EINVAL indicates that
either tha original gangsta binary policy image or tha generated one were
invalid. Y'all KNOW dat shit, muthafucka!  An errno of ENOMEM indicates dat insufficient memory was
available ta process tha original gangsta binary policy image or ta generate
the freshly smoked up policy image.  Invalid entries up in tha user configuration files
are skipped wit a warning.
