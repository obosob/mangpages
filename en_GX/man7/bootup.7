'\" t
.TH "BOOTUP" "7" "" "systemd 208" "bootup"
.\" -----------------------------------------------------------------
.\" * Define some portabilitizzle stuff
.\" -----------------------------------------------------------------
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.\" http://bugs.debian.org/507673
.\" http://lists.gnu.org/archive/html/groff/2009-02/msg00013.html
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\" -----------------------------------------------------------------
.\" * set default formatting
.\" -----------------------------------------------------------------
.\" disable hyphenation
.nh
.\" disable justification (adjust text ta left margin only)
.ad l
.\" -----------------------------------------------------------------
.\" * MAIN CONTENT STARTS HERE *
.\" -----------------------------------------------------------------
.SH "NAME"
bootup \- System bootup process
.SH "DESCRIPTION"
.PP
A number of different components is involved up in tha system boot\&. Immediately afta power\-up, tha system BIOS will do minimal hardware initialization, n' hand control over ta a funky-ass boot loader stored on a persistent storage device\&. This boot loader will then invoke a OS kernel from disk (or tha network)\&. In tha Linux case, dis kernel (optionally) extracts n' executes a initial RAM disk image (initrd), like fuckin generated by
\fBdracut\fR(8), which looks fo' tha root file system (possibly using
\fBsystemd\fR(1)
for this)\& fo' realz. Afta tha root file system is found n' mounted, tha initrd handz over control ta tha host\*(Aqs system manager (such as
\fBsystemd\fR(1)) stored on tha OS image, which is then responsible fo' probin all remainin hardware, mountin all necessary file systems n' spawnin all configured skillz\&.
.PP
On shutdown, tha system manager stops all skillz, unmounts all file systems (detachin tha storage technologies backin them), n' then (optionally) jumps back tha fuck into tha initrd code which unmounts/detaches tha root file system n' tha storage it resides on\& fo' realz. As a last step, tha system is powered down\&.
.PP
Additionizzle shiznit bout tha system boot process may be found in
\fBboot\fR(7)\&.
.SH "SYSTEM MANAGER BOOTUP"
.PP
At boot, tha system manager on tha OS image is responsible fo' initializin tha required file systems, skillz n' drivers dat is necessary fo' operation of tha system\&. On
\fBsystemd\fR(1)
systems, dis process is split up in various discrete steps which is exposed as target units\&. (See
\fBsystemd.target\fR(5)
for detailed shiznit bout target units\&.) Da boot\-up process is highly parallelized so dat tha order up in which specific target units is reached aint deterministic yo, but still adheres ta a limited amount of orderin structure\&.
.PP
When systemd starts up tha system, it will activate all units dat is dependencies of
default\&.target
(as well as recursively all dependenciez of these dependencies)\&. Usually,
default\&.target
is simply a alias of
graphical\&.target
or
multi\-user\&.target, dependin on whether tha system is configured fo' a graphical UI or only fo' a text console\&. To enforce minimal orderin between tha units pulled in, a fuckin shitload of well\-known target units is available, as listed on
\fBsystemd.special\fR(7)\&.
.PP
Da followin chart be a structural overview of these well\-known units n' they posizzle up in tha boot\-up logic\&. Da arrows describe which units is pulled up in n' ordered before which other units\&. Units near tha top is started before units nearer ta tha bottom of tha chart\&.
.sp
.if n \{\
.RS 4
.\}
.nf
local\-fs\-pre\&.target
         |
         v
(various mounts n'   (various swap   (various cryptsetup
 fsck skillz\&.\&.\&.)     devices\&.\&.\&.)        devices\&.\&.\&.)       (various low\-level   (various low\-level
         |                  |                  |             skillz: udevd,     API VFS mounts:
         v                  v                  v             tmpfiles, random     mqueue, configfs,
  local\-fs\&.target      swap\&.target     cryptsetup\&.target    seed, sysctl, \&.\&.\&.)      debugfs, \&.\&.\&.)
         |                  |                  |                    |                    |
         \e__________________|_________________ | ___________________|____________________/
                                              \e|/
                                               v
                                        sysinit\&.target
                                               |
          ____________________________________/|\e________________________________________
         /                  |                  |                    |                    \e
         |                  |                  |                    |                    |
         v                  v                  |                    v                    v
     (various           (various               |                (various          rescue\&.service
    timers\&.\&.\&.)          paths\&.\&.\&.)              |               sockets\&.\&.\&.)               |
         |                  |                  |                    |                    v
         v                  v                  |                    v              \fIrescue\&.target\fR
   timers\&.target      paths\&.target             |             sockets\&.target
         |                  |                  |                    |
         \e__________________|_________________ | ___________________/
                                              \e|/
                                               v
                                         basic\&.target
                                               |
          ____________________________________/|                                 emergency\&.service
         /                  |                  |                                         |
         |                  |                  |                                         v
         v                  v                  v                                 \fIemergency\&.target\fR
     display\-        (various system    (various system
 manager\&.service         skillz           skillz)
         |             required fo'            |
         |            graphical UIs)           v
         |                  |           \fImulti\-user\&.target\fR
         |                  |                  |
         \e_________________ | _________________/
                           \e|/
                            v
                  \fIgraphical\&.target\fR
.fi
.if n \{\
.RE
.\}
.PP
Target units dat is commonly used as boot targets are
\fIemphasized\fR\&. These units is phat chizzlez as goal targets, fo' example by passin dem ta the
\fIsystemd\&.unit=\fR
kernel command line option (see
\fBsystemd\fR(1)) or by symlinking
default\&.target
to them\&.
.SH "BOOTUP IN THE INITIAL RAM DISK (INITRD)"
.PP
Da initial RAM disk implementation (initrd) can be set up rockin systemd as well\&. In dis case, boot up inside tha initrd bigs up tha followin structure\&.
.PP
Da default target up in tha initrd is
initrd\&.target\&. Da bootup process begins identical ta tha system manager bootup (see above) until it reaches
basic\&.target\&. From there, systemd approaches tha special target
initrd\&.target\&. If tha root thang can be mounted at
/sysroot, the
sysroot\&.mount
unit becomes actizzle and
initrd\-root\-fs\&.target
is reached\&. Da service
initrd\-parse\-etc\&.service
scans
/sysroot/etc/fstab
for a possible
/usr
mount point n' additionizzle entries marked wit the
\fIx\-initrd\&.mount\fR
option\& fo' realz. All entries found is mounted below
/sysroot, and
initrd\-fs\&.target
is reached\&. Da service
initrd\-cleanup\&.service
isolates ta the
initrd\-switch\-root\&.target, where cleanup skillz can run\& fo' realz. As tha straight-up last step, the
initrd\-switch\-root\&.service
is activated, which will cause tha system ta switch its root to
/sysroot\&.
.sp
.if n \{\
.RS 4
.\}
.nf
                                               : (beginnin identical ta above)
                                               :
                                               v
                                         basic\&.target
                                               |                                 emergency\&.service
                        ______________________/|                                         |
                       /                       |                                         v
                       |                  sysroot\&.mount                          \fIemergency\&.target\fR
                       |                       |
                       |                       v
                       |             initrd\-root\-fs\&.target
                       |                       |
                       |                       v
                       v            initrd\-parse\-etc\&.service
                (custom initrd                 |
                 skillz\&.\&.\&.)                  v
                       |            (sysroot\-usr\&.mount and
                       |             various mounts marked
                       |               wit fstab option
                       |              x\-initrd\&.mount\&.\&.\&.)
                       |                       |
                       |                       v
                       |                initrd\-fs\&.target
                       \e______________________ |
                                              \e|
                                               v
                                          initrd\&.target
                                               |
                                               v
                                     initrd\-cleanup\&.service
                                          isolates to
                                    initrd\-switch\-root\&.target
                                               |
                                               v
                        ______________________/|
                       /                       v
                       |        initrd\-udevadm\-cleanup\-db\&.service
                       v                       |
                (custom initrd                 |
                 skillz\&.\&.\&.)                  |
                       \e______________________ |
                                              \e|
                                               v
                                   initrd\-switch\-root\&.target
                                               |
                                               v
                                   initrd\-switch\-root\&.service
                                               |
                                               v
                                     Transizzle ta Host OS
.fi
.if n \{\
.RE
.\}
.SH "SYSTEM MANAGER SHUTDOWN"
.PP
System shutdown wit systemd also consistz of various target units wit some minimal orderin structure applied:
.sp
.if n \{\
.RS 4
.\}
.nf
                                  (conflicts wit  (conflicts with
                                    all system     all file system
                                     skillz)     mounts, swaps,
                                         |           cryptsetup
                                         |          devices, \&.\&.\&.)
                                         |                |
                                         v                v
                                  shutdown\&.target    umount\&.target
                                         |                |
                                         \e_______   ______/
                                                 \e /
                                                  v
                                         (various low\-level
                                              skillz)
                                                  |
                                                  v
                                            final\&.target
                                                  |
            _____________________________________/ \e_________________________________
           /                         |                        |                      \e
           |                         |                        |                      |
           v                         v                        v                      v
systemd\-reboot\&.service   systemd\-poweroff\&.service   systemd\-halt\&.service   systemd\-kexec\&.service
           |                         |                        |                      |
           v                         v                        v                      v
    \fIreboot\&.target\fR             \fIpoweroff\&.target\fR            \fIhalt\&.target\fR           \fIkexec\&.target\fR
.fi
.if n \{\
.RE
.\}
.PP
Commonly used system shutdown targets are
\fIemphasized\fR\&.
.SH "SEE ALSO"
.PP
\fBsystemd\fR(1),
\fBboot\fR(7),
\fBsystemd.special\fR(7),
\fBsystemd.target\fR(5),
\fBdracut\fR(8)
